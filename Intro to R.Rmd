---
title: "Intro to R"
author: "Joshua de la Bruere"
date: "2/24/2020"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(learnr)
tutorial_options(exercise.eval = TRUE)

```
```{r imports, echo=FALSE, message=FALSE}

suppressMessages(library(tidyverse))
library(DT)
```
## Welcome

This is a tutorial/teaching tool to help those who are used to using Excel for data maniupation to help them get onboard with R. This is part 1 in a series of 4 tutorials to get help get familiar with R.

### Outline

In this part of the tutorial, we will

* Make a use case for R
* explain The basics of R
* explain The Similaritites of R and Excel


### Is this tutorial for you?

This tutorial may not be right for you. This tutorial makes some assumptions that you have already have knoweldge of Excel, and know how to/have set up R and R studio. This doesn't assume deep programing background, though it will be helpful.

If you need help installing R [This tutorial](https://learnr-examples.shinyapps.io/ex-setup-r/) may be a little more helpful.


## The Pitch For R

Most commonly, when I'm trying to convince someone to try to learn R, they ask me why? They're already comfortable with excel, and have processes for their reports, and data manipulations. I understand that, when I first started learning R it was for one purpose, to do **Machine Learning** that I couldn't expect Excel to do. I did all of my data exploration, cleaning, and manipulating in Excel, as I as familiar with the interface and knew the shortcuts. 

My pitch for using R more is pretty simple, it let's you do more, faster. Using R you can create reproduceable reports, and functions to enable you to run the report on new data with ease. You can do excel reports that take an hour to calculate in a handful of seconds. 

In Excel, your pipline/process is usually 

* Manual
* Step by step
* Involves copying and pasting special values, or formula
* calculation intesnive
* Difficult to reverse engineer/Reproduce/Audit
* Require many steps to explain how it works.

In R your process can be

* Automated
* Run all steps at once
* Calculate on entire columns rather than cell by cell
* Readable
* Easily Repoduceable


### What about VBA?

VBA is a powerful tool that enables automated reports and calculations to reduce manual errors in an Excel report. It's native to Excel and can be used to keep your work entierly in Excel. It is however, difficult to get started with, slower, and not nearly as well documented as R. This is because R is designed for data. R is a statistics language and optimized to work with data, where as VBA is designed to be a basic programing interface. VBA mimics how a human would have to approach the process, where as R can manage the problem in a progmatic manner.


To demonstate this, lets take a look at this example problem. You have to calculate if a student is experiencing chronic attendence issues. You want to add a new column where the value is chronic if they have more then 10 attendence issues, with 4 tardies = 1 absense.  Your spreadsheet looks like this. 

```{r, echo=FALSE, message=FALSE}
attendence_data <- read_csv("Data/attendence_data.csv")
datatable(attendence_data)

```

```
Sub addNewColumnCalc()

  Dim LastRow as Long
  LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
  Selection.End(xlToRight).Select
  Range("F1").Select
  ActiveCell.FormulasR1C1 = "AttendenceIssues"
  Range("F2").Select
  ActiveCell.ForulaR1C1 = "IF((RC[-2]-RC[-1]/4)>=10, ""Chronic"", "Acceptable"")"
  Selection.FillDown
  Selection.Copy
  Selection.pasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlankes:=False, Transpose:=False
End Sub

```

And in R it could look like: 

```
attendence_data <- attendence_data %>% 
  mutate(attendence_issues =  if_else(Absenses + Tardies/4 >= 10, "Chonic", "Acceptable")) 
```

Which is clearly much simpler and easier to read. 

### Better Plots


You can also make much more dynamic plots in R vs Excel, and tweek more options to capture the story that your data tells. We'll dive into plotting later, with a focus on the [**ggplot2** package](https://ggplot2.tidyverse.org/)

For example this was a fairly simple plot to make using R, that would take a few minutes of clicking around in excel to produce a similar result. 

```{r}
attendence_data <- attendence_data %>% 
  mutate(attendence_issues =  if_else(Absenses + Tardies/4 >= 10, "Chonic", "Acceptable")) 

attendence_data %>%
  ggplot(aes(x=Absenses, y= Tardies, color=attendence_issues))+
  geom_point(size=3)+
  theme_minimal()+
  theme(legend.position = "top")
```
  
  
  
### Conclusion
I hope by now you're at least a little intriuged about using R to incease your productivity and eliminating your frustrations with work. R is more readable, repoducable, and easier to maintain between users than that old .xlsxm file that gets emailed around between all your users. 





## The Basics of R

### The R Console

R like many other programing languages has a *Console* which can be used by the user to exicute various commands. In R Studio, the console is one of the panes you can have open and is open by default. We can also run *Scripts* which are like the console, except they hold multiple commands to be run repeatedly. This tutorial uses the [**learnr** package](https://rstudio.github.io/learnr/) to provide an interface for you to get used to R. This will function as your console. 

```{r, message=FALSE, echo=FALSE}
message <- "Welcome to R! Get ready for some practice!"
```
Give it a try, I've left you a message. To read it, type ```print(message)``` in the following code chunk.

```{r first_code_chunk, exercise=TRUE}



```

### Basic Calculations

So what can we do in the R console? Much like formulas in excel, we can use R as an overly complicated calcuator. R knows basic arithmatic and you can type a calcuation and r will provide a result. You can ask it what 2+2 is or what 3*10 is and it will get you the answer. 

R undersands 

* Basic arithmatic symbols (`+-*/^`)
* averageing(`mean(c(x1,x2,x3)), median(c(x1,x2,x3)`)
* exponents and logs(`log(x, base = exp(1), exp()`) )
* square roots (`sqrt(x)`)

Note that for averaging, R needs a **Vector** instead of just comma seperated values in excel. A Vector is very easy to create, you just **c** combine comma seperated values into a vector using `c(item_1, item_2, ... item_n)`

Why don't you create a vector of this list, "10, 14, 2, 5, 5, 2, 15, 14, 12, 11, 13" and store it as `first_vector`. We can store values as variables by using the `<-` operator like so.

```{r}
example_variable <- "A value"

print(example_variable)
```


Now give it a shot. Create a vector named first_vector and set it's values to the ones provided above and find the mean and median.

```{r first_vector, exercise=TRUE}
first_vector <- c(1)

mean_value <- mean(1)
median_value <- median(1)
```

<!-- Run this chunk to see if you have the right values. -->
<!-- ```{r, message=FALSE, echo=FALSE} -->

<!-- check_vector <- c(10, 14, 2, 5, 5, 2, 15, 14, 12, 11, 13) -->

<!-- mean_value_check <- mean(check_vector) -->
<!-- median_value_check <- median(check_vector) -->

<!-- ``` -->


<!-- ```{r first_vector_check,  exercise=TRUE} -->


<!-- if_else(first_vector ==  check_vector, T,F) -->

<!-- if_else(mean_value ==  mean_value_check, T,F) -->

<!-- if_else(median_value ==  median_value_check, T,F) -->

<!-- ``` -->


#### Basic Calcualtion Exercises

Using the r console, find the answer to the following set of problems. 


```{r mathConsole, exersise =TRUE}
```

```{r math1, echo=FALSE}
question("What is 8^7 ?", 
         answer("2097152", correct = TRUE), 
         answer("5764801"), 
         answer("8773.065"),
         answer("56"),
         allow_retry = TRUE)

```
```{r math2, echo=FALSE}
question(sprintf("what is the square root of 4^2 + 5^2 ?"), 
         answer("96.4987"), 
         answer("5.671858"), 
         answer("7.5"),
         answer("6.403124", correct = TRUE),
         allow_retry = TRUE)

```
```{r math3, echo=FALSE}
question("what is the difference between the medain and mean of the following list of numbers? '1, 5, 3, 10, 21, 4, 15, 24", 
         answer("96.4987"), 
         answer("2.875", correct=TRUE), 
         answer("7.5"),
         answer(" -2.875"),
         allow_retry = TRUE)

```


### Variables and Assignment

As mentioned above, we can store values with a name, This is called a *variable*. This is similar to doing a calculation adn stoing it in a specific cell to reference later. As mentioned before, it's best practice to assign values the variable. Variables can be single values, or data structures with multiple values like vectors.

#### Naming guidelines
In general, your variable names should be descriptive and clear. There are a few different ways to style your variables, but you should strive to be consistant. The [tidyverse style guide](http://adv-r.had.co.nz/Style.html) reccomends using an underscore to seperate words in a variable name. This is called snake_ _case. [Google's R style guide](https://google.github.io/styleguide/Rguide.html) uses BigCamelCase. It's important to have a consistant convention so that way you can quickly access your variables and make it easier for others to read.

Some limitations on variable names

* Variable names must consist of letters, numbers, the underscore, or periods
* They can't start with numbers
* they can't be reserved characters
  + c q t C D F I T
* They can't be reserved words
  + if, else, repeat, while, function, for, in, next, break, TRUE, FALSE, NULL, Inf, NaN, NA, NA_integer_, NA_real_, NA_complex_, NA_character_
* Variables are case sensitive
  + var1 and Var1 are different
  
#### Vectors 
Vectors are a list of values that are strung together. We can use these to hold a colection of numerical, or character data. For numeric values we have some built in functions to summerise them. These are very similar to using the formulas in excel to do calcuations over a range.

* `sum(x)` sums the total 
* `length(x)` gets the number of values in the vectors
* `mean(x)` finds the mean 
* `var(x)` calculates the varience of the vector
* `sd(x)` calculates the standard deviation
* `max(x)` finds the largest value
* `min(x)` finds the smallest value
* `median(x)` finds the median
* `y = sort(x)` Sorts the values in acending order

values in a list are *indexed* which means you can access a specific value if you need to by using square brackets after the vectors name like in the following code chunk.

```{r}
my_vector <- c(1,3,6,9,12,15)

print(my_vector[4])
```

R's index is numbered similar to how Excel numbers its columns and rows, starting the index at 1. If you need the 5th item in a list, then use the number 5. It's intuitve and will become second nature as you use R more. 


#### Vectors and Variables Problems



### Data Frames




## What's The Same



